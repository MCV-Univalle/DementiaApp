{"ast":null,"code":"var AffectiveRelation = require('../models/affectiveRelation.model');\n\nvar Photo = require('../models/photo.model');\n\nvar mongoose = require('mongoose');\n\nexports.newPhotoUpdate = function (req, res) {\n  AffectiveRelation.findOne({\n    _id: req.params.id\n  }).then(function (affectiveRelation, err) {\n    var newPhoto = new Photo({\n      description: req.body.description,\n      img: req.file.path,\n      affectiveRelation: affectiveRelation._id\n    });\n    newPhoto.save(function (err) {\n      if (err) {\n        return res.status(400).send({\n          message: \"Error uploading photo \".concat(err)\n        });\n      }\n\n      res.status(200).send(\"\".concat(newPhoto));\n    });\n    affectiveRelation.photo.push(newPhoto);\n    affectiveRelation.save()[\"catch\"](function (err) {\n      console.error(err);\n    });\n  });\n};\n\nexports.pruebaconjson = function (req, res) {\n  var images = req.body.images;\n  images.forEach(function (element) {\n    console.log(element.description);\n  });\n  console.log(req.body);\n}; //Find all the affective relations\n\n\nexports.findAll = function (req, res) {\n  AffectiveRelation.find().then(function (affectiveRelation) {\n    res.send(affectiveRelation);\n  })[\"catch\"](function (err) {\n    res.status(500).send({\n      message: err.message\n    });\n  });\n}; //Find all affectiveRelations by a user\n\n\nexports.findByUserAffective = function (req, res) {\n  AffectiveRelation.find({\n    user: req.params.userId\n  }).populate('photo').exec(function (err, affectiverelations) {\n    if (err) {\n      if (err.kind === 'ObjectId') {\n        return res.status(404).send({\n          message: \"Affections not found with given Affective Relation Id \" + req.params.userId\n        });\n      }\n\n      return res.status(500).send({\n        message: \"Error retrieving Affections with given user Id \" + req.params.userId\n      });\n    }\n\n    res.send(affectiverelations);\n  });\n};","map":null,"metadata":{},"sourceType":"script"}