{"ast":null,"code":"var config = require('../services/jwt.service');\n\nfunction isAuth(req, res, next) {\n  if (!req.headers.authorization) {\n    return res.status(403).send({\n      message: 'You dont have permission to access'\n    });\n  }\n\n  var token = req.headers.authorization.split(\" \")[1];\n  config.decodeToken(token).then(function (response) {\n    req.user = response;\n    next();\n  })[\"catch\"](function (response) {\n    res.status(response.status);\n  });\n}\n\nmodule.exports = {\n  isAuth: isAuth\n};","map":null,"metadata":{},"sourceType":"script"}